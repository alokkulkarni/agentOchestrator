# Routing Rules Configuration
# Rules are evaluated in priority order (highest first)
# When a rule matches, the specified agents are called

rules:
  # High-priority rule for math/calculation queries
  - name: "math_queries"
    priority: 100
    conditions:
      - field: "query"
        operator: "contains"
        value: "calculate"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "add"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "subtract"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "multiply"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "divide"
        case_sensitive: false
      - field: "query"
        operator: "regex"
        value: "\\d+\\s*[+\\-*/]\\s*\\d+"
        case_sensitive: false
      - field: "operands"
        operator: "exists"
        value: null
        case_sensitive: false
    logic: "or"  # Match if ANY condition is true
    target_agents:
      - "calculator"
    confidence: 0.95
    enabled: true

  # Rule for web/internet search queries (Tavily)
  - name: "web_search_queries"
    priority: 95
    conditions:
      - field: "query"
        operator: "contains"
        value: "web search"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "internet search"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "online"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "latest"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "current"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "real-time"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "news"
        case_sensitive: false
    logic: "or"
    target_agents:
      - "tavily_search"
    confidence: 0.90
    enabled: true

  # Rule for search/retrieval queries (local documents)
  - name: "search_queries"
    priority: 90
    conditions:
      - field: "query"
        operator: "contains"
        value: "search"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "find"
        case_sensitive: false
    logic: "or"
    target_agents:
      - "search"
    confidence: 0.85
    enabled: true

  # Rule for application planning queries
  - name: "planning_queries"
    priority: 98
    conditions:
      - field: "query"
        operator: "contains"
        value: "application plan"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "project plan"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "software plan"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "build an app"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "build a web"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "build a mobile"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "create an app"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "create a website"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "design application"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "design system"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "develop application"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "develop software"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "trip itinerary"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "travel itinerary"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "plan a trip"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "plan my trip"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "itinerary from"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "requirements"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "user stories"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "user story"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "epics"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "epic"
        case_sensitive: false
      - field: "requirements"
        operator: "exists"
        value: null
        case_sensitive: false
    logic: "or"
    target_agents:
      - "planning"
    confidence: 0.95
    enabled: true

  # Rule for tech insights queries
  - name: "tech_insights_queries"
    priority: 92
    conditions:
      - field: "query"
        operator: "contains"
        value: "insights"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "trends"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "top 20"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "software engineering"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "tech trends"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "technology trends"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "programming trends"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "ai trends"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "ml trends"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "latest in tech"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "what's new"
        case_sensitive: false
    logic: "or"
    target_agents:
      - "tech_insights"
    confidence: 0.92
    enabled: true

  # Rule for weather-related queries
  - name: "weather_queries"
    priority: 85
    conditions:
      - field: "query"
        operator: "contains"
        value: "weather"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "forecast"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "temperature"
        case_sensitive: false
    logic: "or"
    target_agents:
      - "weather"
    confidence: 0.90
    enabled: true

  # Rule for data transformation queries (HIGH PRIORITY - checks for data field)
  - name: "data_processing"
    priority: 105
    conditions:
      - field: "data"
        operator: "exists"
        value: null
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "transform"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "process"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "filter"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "aggregate"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "group"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "employee data"
        case_sensitive: false
      - field: "query"
        operator: "contains"
        value: "data processor"
        case_sensitive: false
    logic: "or"
    target_agents:
      - "data_processor"
    confidence: 0.95
    enabled: true

  # Catch-all rule with low priority (uses multiple agents)
  - name: "general_query"
    priority: 10
    conditions:
      - field: "query"
        operator: "exists"
        value: null
        case_sensitive: false
    logic: "and"
    target_agents:
      - "search"
      - "calculator"
    confidence: 0.5
    enabled: false  # Disabled by default to avoid unnecessary agent calls
